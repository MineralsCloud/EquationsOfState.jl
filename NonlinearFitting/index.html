<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Nonlinear fitting · EquationsOfState.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="EquationsOfState.jl logo"/></a><h1>EquationsOfState.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../Collections/">Collections</a></li><li class="current"><a class="toctext" href>Nonlinear fitting</a><ul class="internal"><li><a class="toctext" href="#Usage-1">Usage</a></li><li><a class="toctext" href="#Public-interfaces-1">Public interfaces</a></li><li><a class="toctext" href="#References-1">References</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Nonlinear fitting</a></li></ul><a class="edit-page" href="https://github.com/MineralsCloud/EquationsOfState.jl/blob/master/docs/src/NonlinearFitting.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Nonlinear fitting</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Nonlinear-fitting-1" href="#Nonlinear-fitting-1">Nonlinear fitting</a></h1><p>From Ref. 1,</p><blockquote><p>The equations of state depend nonlinearly of a collection of parameters, <span>$E_0$</span>, <span>$V_0$</span>, <span>$B_0$</span>, <span>$B_0&#39;$</span>, ..., that represent physical properties of the solid at equilibrium and can, in principle, be obtained expermentally by independent methods. The use of a given analytical EOS may have significant influence on the results obtained, particularly because the parameters are far from being independent. The number of parameters has to be considered in comparing the goodness of fit of functional forms with different analytical flexibility. The possibility of using too many parameters, beyond what is physically justified by the information contained in the experimental data, is a serious aspect that deserves consideration.</p></blockquote><p>In <a href="https://github.com/MineralsCloud/EquationsOfState.jl"><code>EquationsOfState</code></a>, the nonlinear fitting is currently implemented by <a href="https://github.com/JuliaNLSolvers/LsqFit.jl"><code>LsqFit</code></a>, a small library that provides basic least-squares fitting in pure Julia. It only utilizes the <em>Levenberg-Marquardt algorithm</em> for non-linear fitting. See its <a href="https://github.com/JuliaNLSolvers/LsqFit.jl/blob/master/README.md">documentation</a> for more information.</p><h2><a class="nav-anchor" id="Usage-1" href="#Usage-1">Usage</a></h2><p>We provide API <code>lsqfit</code> currently.</p><pre><code class="language-julia">using EquationsOfState
using EquationsOfState.Collections
using EquationsOfState.NonlinearFitting

volumes = [
    25.987454833,
    26.9045702104,
    27.8430241908,
    28.8029649591,
    29.7848370694,
    30.7887887064,
    31.814968055,
    32.8638196693,
    33.9353435494,
    35.0299842495,
    36.1477417695,
    37.2892088485,
    38.4543854865,
    39.6437162376,
    40.857201102,
    42.095136449,
    43.3579668329,
    44.6456922537,
    45.9587572656,
    47.2973100535,
    48.6614988019,
    50.0517680652,
    51.4682660281,
    52.9112890601,
    54.3808371612,
    55.8775030703,
    57.4014349722,
    58.9526328669
]
energies = [
    -7.63622156576,
    -8.16831294894,
    -8.63871612686,
    -9.05181213218,
    -9.41170988374,
    -9.72238224345,
    -9.98744832526,
    -10.210309552,
    -10.3943401353,
    -10.5427238068,
    -10.6584266073,
    -10.7442240979,
    -10.8027285713,
    -10.8363890521,
    -10.8474912964,
    -10.838157792,
    -10.8103477586,
    -10.7659387815,
    -10.7066179666,
    -10.6339907853,
    -10.5495538639,
    -10.4546677714,
    -10.3506386542,
    -10.2386366017,
    -10.1197772808,
    -9.99504030111,
    -9.86535084973,
    -9.73155247952
]

lsqfit(EnergyRelation, BirchMurnaghan3rd(40, 0.5, 4, 0), volumes, energies)
lsqfit(EnergyRelation, Murnaghan(41, 0.5, 4, 0), volumes, energies)
lsqfit(EnergyRelation, PoirierTarantola3rd(41, 0.5, 4, 0), volumes, energies)
lsqfit(EnergyRelation, Vinet(41, 0.5, 4, 0), volumes, energies)</code></pre><p>Then 4 different equations of state will be fitted.</p><h2><a class="nav-anchor" id="Public-interfaces-1" href="#Public-interfaces-1">Public interfaces</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="EquationsOfState.NonlinearFitting.lsqfit-Union{Tuple{Y}, Tuple{X}, Tuple{E}, Tuple{Type{#s27} where #s27&lt;:EquationOfStateRelation,E,X,Y}} where Y&lt;:(AbstractArray{T,1} where T) where X&lt;:(AbstractArray{T,1} where T) where E&lt;:EquationsOfState.Collections.EquationOfState" href="#EquationsOfState.NonlinearFitting.lsqfit-Union{Tuple{Y}, Tuple{X}, Tuple{E}, Tuple{Type{#s27} where #s27&lt;:EquationOfStateRelation,E,X,Y}} where Y&lt;:(AbstractArray{T,1} where T) where X&lt;:(AbstractArray{T,1} where T) where E&lt;:EquationsOfState.Collections.EquationOfState"><code>EquationsOfState.NonlinearFitting.lsqfit</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">lsqfit(T, eos, xdata, ydata; debug = false, kwargs...)</code></pre><p>Fit an equation of state using least-squares fitting method (with the Levenberg-Marquardt algorithm).</p><p><strong>Arguments</strong></p><ul><li><code>T::Type{&lt;:EquationOfStateRelation}</code>: an <code>EquationOfStateRelation</code>. If it is <code>EnergyRelation</code>, fit <span>$E(V)$</span>; if <code>PressureRelation</code>, fit <span>$P(V)$</span>; if <code>BulkModulusRelation</code>, fit <span>$B(V)$</span>.</li><li><code>eos::EquationOfState</code>: a trial equation of state.</li><li><code>xdata::AbstractVector</code>: a vector of volumes.</li><li><code>ydata::AbstractVector</code>: a vector of energies, pressures, or bulk moduli.</li><li><code>debug::Bool=false</code>: if <code>true</code>, then an <code>LsqFit.LsqFitResult</code> is returned, containing estimated Jacobian, residuals, etc.; if <code>false</code>, a fitted <code>EquationOfState</code> is returned. The default value is <code>false</code>.</li><li><code>kwargs</code>: the rest keyword arguments that will be sent to <code>LsqFit.curve_fit</code>. See its <a href="https://github.com/JuliaNLSolvers/LsqFit.jl/blob/master/README.md">documentation</a>.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/MineralsCloud/EquationsOfState.jl/blob/4ffc2e2fc219ee176f1aac89485ed0d5df1b4f21/src/NonlinearFitting.jl#LL32-L44">source</a></section><h2><a class="nav-anchor" id="References-1" href="#References-1">References</a></h2><ol><li><a href="https://www.sciencedirect.com/science/article/pii/S0010465511001470">A. Otero-De-La-Roza, V. Luaña, <em>Computer Physics Communications</em>. <strong>182</strong>, 1708–1720 (2011), doi:10.1016/j.cpc.2011.04.016.</a></li></ol><footer><hr/><a class="previous" href="../Collections/"><span class="direction">Previous</span><span class="title">Collections</span></a></footer></article></body></html>
